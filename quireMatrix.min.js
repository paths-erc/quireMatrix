!function(){var e=function(e){var t="string"==typeof e?document.getElementById(e):e[0],n=t.getContext("2d"),o=t.height,i=t.width,s=20,r=1,a={0:"1",1:"0","0*":"1*","1*":"0*","0+":"1+","1+":"0+","1x":"1x",2:"0","2*":"0",3:"0","3*":"0",4:"0","4*":"0"};function h(){n.moveTo(0,o-r*s),n.lineTo(i/2,o-(r-1)*s)}function l(e){n.beginPath(),e&&n.setLineDash([5]),h(),n.lineTo(0,o-r*s-s/2),n.stroke(),n.setLineDash([])}function g(e){n.beginPath(),e&&n.setLineDash([5]),h(),n.lineTo(0,o-r*s-s/3),n.stroke(),n.moveTo(i/2,o-(r-1)*s),n.lineTo(0,o-r*s-2*s/3),n.stroke(),n.setLineDash([])}function c(e){n.beginPath(),e&&n.setLineDash([5]),h(),n.lineTo(0,o-r*s-s/4),n.stroke(),n.moveTo(i/2,o-(r-1)*s),n.lineTo(0,o-r*s-2*s/4),n.stroke(),n.moveTo(i/2,o-(r-1)*s),n.lineTo(0,o-r*s-3*s/4),n.stroke(),n.setLineDash([])}n.lineWidth=1.5,this.addRow=function(e){"1"===e?(n.beginPath(),h(),n.stroke()):"1+"===e?(n.beginPath(),h(),n.lineTo(i/2+i/10,o-r*s+.75*s),n.stroke()):"1x"===e?(n.beginPath(),h(),n.lineTo(i,o-s*r),n.stroke()):"1x*"===e?(n.beginPath(),n.setLineDash([5]),h(),n.lineTo(i,o-s*r),n.stroke(),n.setLineDash([])):"1*"===e?(n.beginPath(),n.moveTo(0,o-r*s),n.lineTo(i/2,o-(r-1)*s),n.stroke(),n.beginPath(),n.setLineDash([5]),n.moveTo(i/2,o-(r-1)*s),n.lineTo(i,o-s*r),n.stroke(),n.setLineDash([])):"0"===e?(n.beginPath(),n.moveTo(i/2,o-(r-1)*s),n.lineTo(i,o-s*r),n.stroke()):"0*"===e?(n.beginPath(),n.setLineDash([5]),n.moveTo(0,o-r*s),n.lineTo(i/2,o-(r-1)*s),n.stroke(),n.setLineDash([]),n.beginPath(),n.moveTo(i/2,o-(r-1)*s),n.lineTo(i,o-s*r),n.stroke()):"0+"===e?(n.beginPath(),n.moveTo(i,o-r*s),n.lineTo(i/2,o-(r-1)*s),n.lineTo(i/2-i/10,o-r*s+.75*s),n.stroke()):"2"===e?l():"2*"===e?l(!0):"3"===e?g():"3*"===e?g(!0):"4"===e?c():"4*"===e&&c(!0),r++},this.clear=function(){r=1,n.clearRect(0,0,i,o),n.beginPath()},this.parseString=function(e,n){var i=this,r=!!n&&("string"==typeof n?document.getElementById(n):n[0]),h=0;if(i.clear(),!e||""===e)return"";var l=e.replace(/\/$/,"").split("/");l.length>3&&(o=50+l.length*s,t.setAttribute("height",o)),l.forEach(function(e){e&&("1x*"!==e&&(h+=parseInt(e.replace("*","").replace("x",""))),i.addRow(e))});var g=l.reverse();g.forEach(function(e,t,n){if(void 0!==a[e]&&(n[t]=a[e]),e&&"1x*"!==n[t]){var o=n[t]?parseInt(n[t].replace("*","").replace("x","")):0;h+=isNaN(o)?0:o}});var c={text:g.join("/"),tot:2*h};return r?(r.innerHTML="",r.innerHTML="<code><strong>"+c.text+"</strong></code><br>Total: <strong>"+c.tot+"</strong> pages"):console.log(c),c},this.observeInput=function(e,t){var n,o,i,s="string"==typeof e?document.getElementById(e):e[0],r=this;r.parseString(s.value,t),o="input",i=function(){r.parseString(s.value,t)},(n=s).addEventListener?n.addEventListener(o,i,!1):n.attachEvent&&n.attachEvent("on"+o,i)}};"undefined"!=typeof module&&void 0!==module.exports?module.exports=e:window.Matrix=e}();
